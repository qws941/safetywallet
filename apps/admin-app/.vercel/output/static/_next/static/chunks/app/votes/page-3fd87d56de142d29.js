(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61],{8174:function(e,t,n){Promise.resolve().then(n.bind(n,6304))},6304:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f},runtime:function(){return E}});var s=n(7573),r=n(7653),a=n(3400),c=n(1988),i=n(5118),l=n(8948),o=n(2389);let u=(0,o.Z)("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]),d=(0,o.Z)("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),E="edge";function f(){let[e]=(0,r.useState)(null),t="".concat(new Date().getFullYear(),"-").concat(String(new Date().getMonth()+1).padStart(2,"0")),[n,o]=(0,r.useState)(t),{data:E,isLoading:f}=(0,c.a)({queryKey:["votes","results",e,n],queryFn:async()=>(await (0,i.S)("/votes/results?siteId=".concat(e,"&month=").concat(n))).data,enabled:!!e}),N=e=>{let[t,n]=e.split("-");return"".concat(t,"년 ").concat(parseInt(n),"월")},h=e=>1===e?(0,s.jsx)(l.Z,{className:"h-6 w-6 text-yellow-500"}):2===e?(0,s.jsx)(u,{className:"h-6 w-6 text-gray-400"}):3===e?(0,s.jsx)(u,{className:"h-6 w-6 text-amber-600"}):(0,s.jsx)("span",{className:"text-lg font-bold text-gray-400",children:e});return(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,s.jsx)(d,{className:"h-6 w-6 text-yellow-500"}),"우수 근로자 투표"]})}),(0,s.jsx)("div",{className:"flex gap-2 flex-wrap",children:(()=>{let e=[],t=new Date;for(let n=0;n<6;n++){let s=new Date(t.getFullYear(),t.getMonth()-n,1),r="".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0"));e.push(r)}return e})().map(e=>(0,s.jsx)(a.zx,{variant:n===e?"default":"outline",size:"sm",onClick:()=>o(e),children:N(e)},e))}),(0,s.jsxs)(a.Zb,{children:[(0,s.jsx)(a.Ol,{children:(0,s.jsxs)(a.ll,{children:[N(n)," 투표 결과"]})}),(0,s.jsx)(a.aY,{children:e?f?(0,s.jsx)("p",{className:"text-center py-8",children:"로딩 중..."}):(null==E?void 0:E.results)&&E.results.length>0?(0,s.jsx)("div",{className:"space-y-3",children:E.results.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg ".concat(0===t?"bg-yellow-50 border border-yellow-200":"bg-gray-50"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-8 flex justify-center",children:h(t+1)}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.user.nameMasked||e.user.name||"익명"}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.user.companyName,e.user.tradeType&&" \xb7 ".concat(e.user.tradeType)]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("span",{className:"text-2xl font-bold",children:e.voteCount}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground ml-1",children:"표"})]})]},e.user.id))}):(0,s.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"투표 결과가 없습니다."}):(0,s.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"현장을 선택해주세요."})})]})]})}},5118:function(e,t,n){"use strict";n.d(t,{S:function(){return c}});var s=n(8144);let r="https://safework2.jclee.me/api";class a extends Error{constructor(e,t,n){super(e),this.status=t,this.code=n,this.name="ApiError"}}async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{tokens:n,logout:c,setTokens:i}=s.t.getState(),l={"Content-Type":"application/json",...t.headers||{}};(null==n?void 0:n.accessToken)&&(l.Authorization="Bearer ".concat(n.accessToken));let o=await fetch("".concat(r).concat(e),{...t,headers:l});if(401===o.status&&(null==n?void 0:n.refreshToken)){let s=await fetch("".concat(r,"/auth/refresh"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:n.refreshToken})});if(s.ok){let n=await s.json();i(n),l.Authorization="Bearer ".concat(n.accessToken),o=await fetch("".concat(r).concat(e),{...t,headers:l})}else throw c(),new a("Session expired",401,"SESSION_EXPIRED")}if(!o.ok){let e=await o.json().catch(()=>({}));throw new a(e.message||"Request failed",o.status,e.code)}return o.json()}},8144:function(e,t,n){"use strict";n.d(t,{t:function(){return c}});var s=n(8321),r=n(4452),a=n(3212);let c=(0,s.U)()((0,r.tJ)((e,t)=>({user:null,tokens:null,currentSiteId:null,isAdmin:!1,login:(t,n)=>e({user:t,tokens:n,isAdmin:t.role===a.UserRole.SITE_ADMIN||t.role===a.UserRole.SUPER_ADMIN}),logout:()=>e({user:null,tokens:null,currentSiteId:null,isAdmin:!1}),setTokens:t=>e({tokens:t}),setSiteId:t=>e({currentSiteId:t})}),{name:"safetywallet-admin-auth"}))},8948:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(2389).Z)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]])},5363:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8658:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8536:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4602:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6183:function(e,t,n){"use strict";var s=Object.create?function(e,t,n,s){void 0===s&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]},r=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(4602),t),r(n(3700),t),r(n(6668),t),r(n(5769),t),r(n(2232),t),r(n(1098),t),r(n(8658),t),r(n(8536),t)},1098:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5769:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2232:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6668:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3700:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9633:function(e,t){"use strict";var n,s,r,a,c,i,l,o,u,d,E,f,N,h,p,R,O,y,S,I;Object.defineProperty(t,"__esModule",{value:!0}),t.RejectReason=t.TaskStatus=t.ReviewAction=t.ActionStatus=t.ReviewStatus=t.Visibility=t.RiskLevel=t.Category=t.MembershipStatus=t.UserRole=void 0,(E=n||(t.UserRole=n={})).WORKER="WORKER",E.SITE_ADMIN="SITE_ADMIN",E.SUPER_ADMIN="SUPER_ADMIN",E.SYSTEM="SYSTEM",(f=s||(t.MembershipStatus=s={})).PENDING="PENDING",f.ACTIVE="ACTIVE",f.LEFT="LEFT",f.REMOVED="REMOVED",(N=r||(t.Category=r={})).HAZARD="HAZARD",N.UNSAFE_BEHAVIOR="UNSAFE_BEHAVIOR",N.INCONVENIENCE="INCONVENIENCE",N.SUGGESTION="SUGGESTION",N.BEST_PRACTICE="BEST_PRACTICE",(h=a||(t.RiskLevel=a={})).HIGH="HIGH",h.MEDIUM="MEDIUM",h.LOW="LOW",(p=c||(t.Visibility=c={})).WORKER_PUBLIC="WORKER_PUBLIC",p.ADMIN_ONLY="ADMIN_ONLY",(R=i||(t.ReviewStatus=i={})).RECEIVED="RECEIVED",R.IN_REVIEW="IN_REVIEW",R.NEED_INFO="NEED_INFO",R.APPROVED="APPROVED",R.REJECTED="REJECTED",(O=l||(t.ActionStatus=l={})).NONE="NONE",O.REQUIRED="REQUIRED",O.ASSIGNED="ASSIGNED",O.IN_PROGRESS="IN_PROGRESS",O.DONE="DONE",O.REOPENED="REOPENED",(y=o||(t.ReviewAction=o={})).APPROVE="APPROVE",y.REJECT="REJECT",y.REQUEST_MORE="REQUEST_MORE",y.MARK_URGENT="MARK_URGENT",y.ASSIGN="ASSIGN",y.CLOSE="CLOSE",(S=u||(t.TaskStatus=u={})).OPEN="OPEN",S.IN_PROGRESS="IN_PROGRESS",S.DONE="DONE",(I=d||(t.RejectReason=d={})).DUPLICATE="DUPLICATE",I.UNCLEAR_PHOTO="UNCLEAR_PHOTO",I.INSUFFICIENT="INSUFFICIENT",I.FALSE="FALSE",I.IRRELEVANT="IRRELEVANT",I.OTHER="OTHER"},3212:function(e,t,n){"use strict";var s=Object.create?function(e,t,n,s){void 0===s&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]},r=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(9633),t),r(n(5363),t),r(n(6183),t)}},function(e){e.O(0,[995,976,276,400,293,456,744],function(){return e(e.s=8174)}),_N_E=e.O()}]);