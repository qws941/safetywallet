(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[163],{2766:function(e,s,t){Promise.resolve().then(t.bind(t,1688))},1688:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return m}});var n=t(7573),a=t(7653),r=t(3400),l=t(3172),i=t(269),c=t(189);function d(e){let{isOpen:s,onClose:t}=e,[l,d]=(0,a.useState)(""),[o,u]=(0,a.useState)(""),[m,x]=(0,a.useState)(""),[h,f]=(0,a.useState)(new Date().toISOString().split("T")[0]),{data:p}=(0,c.Pe)(),{data:g}=(0,c.LR)(l),j=(0,c._H)();return s?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,n.jsxs)(r.Zb,{className:"w-full max-w-lg bg-white shadow-xl",children:[(0,n.jsxs)(r.Ol,{className:"flex flex-row items-center justify-between border-b px-6 py-4",children:[(0,n.jsx)(r.ll,{children:"수동 승인 생성"}),(0,n.jsx)(r.zx,{variant:"ghost",size:"icon",onClick:t,className:"h-8 w-8 rounded-full p-0",children:(0,n.jsx)(i.Z,{size:20})})]}),(0,n.jsxs)(r.aY,{className:"space-y-4 px-6 py-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"현장 선택"}),(0,n.jsxs)("select",{className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:l,onChange:e=>d(e.target.value),children:[(0,n.jsx)("option",{value:"",children:"현장 선택..."}),null==p?void 0:p.map(e=>(0,n.jsx)("option",{value:e.siteId,children:e.siteName},e.siteId))]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"작업자 선택"}),(0,n.jsxs)("select",{className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:o,onChange:e=>u(e.target.value),disabled:!l,children:[(0,n.jsx)("option",{value:"",children:"작업자 선택..."}),null==g?void 0:g.map(e=>(0,n.jsxs)("option",{value:e.user.id,children:[e.user.nameMasked," (",e.user.phone,")"]},e.user.id))]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"승인 사유 (10자 이상)"}),(0,n.jsx)(r.II,{value:m,onChange:e=>x(e.target.value),placeholder:"승인 사유를 입력하세요"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"유효 날짜"}),(0,n.jsx)(r.II,{type:"date",value:h,onChange:e=>f(e.target.value)})]})]}),(0,n.jsxs)(r.eW,{className:"justify-end gap-2 border-t px-6 py-4",children:[(0,n.jsx)(r.zx,{variant:"outline",onClick:t,children:"취소"}),(0,n.jsx)(r.zx,{onClick:()=>{if(o&&l&&m&&h){if(m.length<10){(0,r.Am)({variant:"destructive",description:"사유는 10자 이상이어야 합니다."});return}j.mutate({userId:o,siteId:l,reason:m,validDate:new Date(h).toISOString()},{onSuccess:()=>{t(),x(""),u(""),d("")},onError:e=>{(0,r.Am)({variant:"destructive",description:"승인 생성 실패: "+e.message})}})}},disabled:j.isPending||!o||!l,children:j.isPending?"처리 중...":"승인"})]})]})}):null}var o=t(6825);function u(e){let{siteId:s}=e,{data:t=[],isLoading:a}=(0,c.m7)(s);return(0,n.jsx)(o.w,{columns:[{key:"user.name",header:"작업자",sortable:!0,render:e=>"".concat(e.user.name||"-"," (").concat(e.user.companyName||"-",")")},{key:"reason",header:"사유",className:"max-w-xs truncate"},{key:"validDate",header:"유효 날짜",sortable:!0,render:e=>new Date(e.validDate).toLocaleDateString("ko-KR")},{key:"approvedBy.name",header:"승인자",render:e=>{var s;return(null===(s=e.approvedBy)||void 0===s?void 0:s.name)||"-"}},{key:"createdAt",header:"생성일",sortable:!0,render:e=>new Date(e.createdAt).toLocaleString("ko-KR")}],data:t,searchable:!0,searchPlaceholder:"이름, 사유 검색...",emptyMessage:a?"로딩 중...":"승인 내역이 없습니다"})}function m(){let[e,s]=(0,a.useState)(!1);return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"승인 관리"}),(0,n.jsxs)(r.zx,{onClick:()=>s(!0),className:"flex items-center gap-2",children:[(0,n.jsx)(l.Z,{size:16}),"수동 승인 생성"]})]}),(0,n.jsx)(u,{}),(0,n.jsx)(d,{isOpen:e,onClose:()=>s(!1)})]})}},6825:function(e,s,t){"use strict";t.d(s,{w:function(){return x}});var n=t(7573),a=t(7653),r=t(2389);let l=(0,r.Z)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),i=(0,r.Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),c=(0,r.Z)("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),d=(0,r.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),o=(0,r.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var u=t(3400),m=t(9147);function x(e){let{columns:s,data:t,pageSize:r=10,searchable:x=!1,searchPlaceholder:h="검색...",onRowClick:f,emptyMessage:p="데이터가 없습니다"}=e,[g,j]=(0,a.useState)(""),[v,b]=(0,a.useState)(null),[y,N]=(0,a.useState)("asc"),[k,w]=(0,a.useState)(0),S=(e,s)=>{let t=s.split("."),n=e;for(let e of t)n=null==n?void 0:n[e];return n},C=(0,a.useMemo)(()=>{let e=[...t];if(g){let s=g.toLowerCase();e=e.filter(e=>Object.values(e).some(e=>String(e).toLowerCase().includes(s)))}return v&&e.sort((e,s)=>{let t=S(e,v),n=S(s,v);if(t===n)return 0;let a=String(null!=t?t:""),r=String(null!=n?n:""),l=a.localeCompare(r);return"asc"===y?l:-l}),e},[t,g,v,y]),z=(0,a.useMemo)(()=>{let e=k*r;return C.slice(e,e+r)},[C,k,r]),I=Math.ceil(C.length/r),Z=e=>{v===e?N("asc"===y?"desc":"asc"):(b(e),N("asc"))};return(0,n.jsxs)("div",{className:"space-y-4",children:[x&&(0,n.jsx)(u.II,{placeholder:h,value:g,onChange:e=>{j(e.target.value),w(0)},className:"max-w-sm"}),(0,n.jsx)("div",{className:"rounded-md border",children:(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{className:"bg-muted/50",children:(0,n.jsx)("tr",{children:s.map(e=>(0,n.jsx)("th",{className:(0,m.cn)("px-4 py-3 text-left text-sm font-medium text-muted-foreground",e.sortable&&"cursor-pointer select-none",e.className),onClick:e.sortable?()=>Z(String(e.key)):void 0,children:(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[e.header,e.sortable&&(0,n.jsx)("span",{className:"text-muted-foreground/50",children:v===e.key?"asc"===y?(0,n.jsx)(l,{size:16}):(0,n.jsx)(i,{size:16}):(0,n.jsx)(c,{size:16})})]})},String(e.key)))})}),(0,n.jsx)("tbody",{children:0===z.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:s.length,className:"px-4 py-8 text-center text-muted-foreground",children:p})}):z.map((e,t)=>(0,n.jsx)("tr",{className:(0,m.cn)("border-t",f&&"cursor-pointer hover:bg-muted/50"),onClick:()=>null==f?void 0:f(e),children:s.map(s=>{var t;return(0,n.jsx)("td",{className:(0,m.cn)("px-4 py-3 text-sm",s.className),children:s.render?s.render(e):String(null!==(t=S(e,String(s.key)))&&void 0!==t?t:"-")},String(s.key))})},t))})]})}),I>1&&(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("p",{className:"text-sm text-muted-foreground",children:["총 ",C.length,"개 중 ",k*r+1,"-",Math.min((k+1)*r,C.length),"개"]}),(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)(u.zx,{variant:"outline",size:"icon",onClick:()=>w(k-1),disabled:0===k,children:(0,n.jsx)(d,{size:16})}),(0,n.jsx)(u.zx,{variant:"outline",size:"icon",onClick:()=>w(k+1),disabled:k>=I-1,children:(0,n.jsx)(o,{size:16})})]})]})]})}},9147:function(e,s,t){"use strict";t.d(s,{cn:function(){return n.cn}});var n=t(3400)},3172:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(2389).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},269:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(2389).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[995,976,276,400,189,293,456,744],function(){return e(e.s=2766)}),_N_E=e.O()}]);