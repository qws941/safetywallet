# ============================================================================
# SafetyWallet Environment Variables
# ============================================================================
# Architecture: Cloudflare Workers (Hono) + D1 + R2 + Hyperdrive
# This file documents all environment variables across the monorepo.
# CF Workers secrets are set via `wrangler secret put <KEY>` (production)
# or `apps/api-worker/.dev.vars` (local dev).
# ============================================================================

# ─── API Worker: Secrets (wrangler secret put) ──────────────────────────────
# These are NOT in wrangler.toml. Set via CF dashboard or CLI.

JWT_SECRET=your_jwt_secret_here_at_least_32_chars
HMAC_SECRET=your_hmac_secret_at_least_32_chars
ENCRYPTION_KEY=your_encryption_key_at_least_32_chars

# Slack webhook for CI/deploy failure alerts
ALERT_WEBHOOK_URL=https://hooks.slack.com/services/xxx/xxx/xxx

# FAS sync authentication secret
FAS_SYNC_SECRET=your_fas_sync_secret_here

# Web Push (VAPID) — generate via `npx web-push generate-vapid-keys`
VAPID_PUBLIC_KEY=your_vapid_public_key
VAPID_PRIVATE_KEY=your_vapid_private_key

# Optional: Elasticsearch for structured logging (requires CF Tunnel to LAN)
ELASTICSEARCH_URL=http://192.168.50.105:9200

# ─── API Worker: Vars (wrangler.toml [vars]) ────────────────────────────────
# These are in wrangler.toml and NOT secret.

ENVIRONMENT=production
REQUIRE_ATTENDANCE_FOR_LOGIN=true
REQUIRE_ATTENDANCE_FOR_POST=true
ELASTICSEARCH_INDEX_PREFIX=safetywallet
ALLOWED_ORIGINS=https://safetywallet.jclee.me,https://admin.safetywallet.jclee.me
VAPID_SUBJECT=mailto:admin@safetywallet.jclee.me

# ─── AceTime MariaDB (local dev only, .dev.vars) ────────────────────────────
# Production uses Hyperdrive binding (FAS_HYPERDRIVE) configured in wrangler.toml.
# These are only needed for local `wrangler dev` when Hyperdrive is unavailable.

ACETIME_DB_HOST=your_acetime_host
ACETIME_DB_PORT=3306
ACETIME_DB_USER=your_acetime_user
ACETIME_DB_PASSWORD=your_acetime_password_here
ACETIME_DB_NAME=your_acetime_db

# ─── Frontend: Admin App ────────────────────────────────────────────────────
# File: apps/admin-app/.env.production

NEXT_PUBLIC_API_URL=/api

# ─── Frontend: Worker App ───────────────────────────────────────────────────
# No environment variables required. Uses relative /api path.

# ─── CF Bindings (wrangler.toml, NOT env vars) ──────────────────────────────
# These are Cloudflare resource bindings, not environment variables.
# Documented here for reference only.
#
# D1:         DB (safetywallet-db)
# R2:         IMAGES_BUCKET (safetywallet-images)
#             STATIC_BUCKET (safetywallet-static)
#             ACETIME_BUCKET (safewallet-acetime)
# Hyperdrive: FAS_HYPERDRIVE (safewallet-acetime-db → MariaDB)
# KV:         RATE_LIMIT_KV
# Queue:      NOTIFICATION_QUEUE (safewallet-notifications)
#             NOTIFICATION_DLQ (safewallet-notifications-dlq)
# DO:         RATE_LIMITER (RateLimiter)
# AI:         AI
# AE:         ANALYTICS, OBSERVABILITY
